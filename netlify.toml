[build]
  # Monorepo için root'ta build yap, her iki Next.js uygulamasını da build et
  # Path-based routing: /necrodev/* -> necrodev, /* -> necroplay
  base = "."
  command = "pnpm run build:netlify"
  # Necroplay root'ta, necrodev /necrodev path'inde
  # Her iki uygulamanın build output'u birleştirilmiş olacak
  publish = "apps/necroplay/.next"

[build.environment]
  NODE_VERSION = "18"
  PNPM_VERSION = "8.12.0"
  # Monorepo için workspace ayarları
  PNPM_FLAGS = "--filter @necroverse/necrodev... --filter @necroverse/necroplay..."

# Path-based routing için redirects
# /necrodev/* -> necrodev uygulamasına yönlendir
# Necrodev basePath ile /necrodev prefix'i eklenmiş, bu yüzden direkt olarak çalışır
# Not: Necrodev build output'u necroplay build output'una merge edilmiş olacak
[[redirects]]
  from = "/necrodev"
  to = "/necrodev/"
  status = 200
  force = true

# Necrodev için tüm path'leri yönlendir
[[redirects]]
  from = "/necrodev/*"
  to = "/necrodev/:splat"
  status = 200
  force = true

# Root ve diğer path'ler -> necroplay uygulamasına yönlendir (Next.js plugin otomatik yönetir)
# Next.js plugin sadece bir uygulama için çalışır, bu yüzden necroplay root'ta
[[plugins]]
  package = "@netlify/plugin-nextjs"
  # Next.js plugin otomatik olarak apps/necroplay dizinindeki Next.js'i algılar
